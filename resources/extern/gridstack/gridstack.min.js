/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/gridstack@2.0.0/dist/gridstack.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";function __export(t){for(var e in t)exports.hasOwnProperty(e)||(exports[e]=t[e])}Object.defineProperty(exports,"__esModule",{value:!0}),require("./gridstack-poly.js");const gridstack_engine_1=require("./gridstack-engine"),utils_1=require("./utils"),gridstack_dd_1=require("./gridstack-dd");__export(require("./utils")),__export(require("./gridstack-engine")),__export(require("./gridstack-dd")),require("./jq/gridstack-dd-jqueryui"),__export(require("./jq/gridstack-dd-jqueryui"));class GridStack{constructor(t,e={}){this._gsEventHandler={},this.setGridWidth=utils_1.obsolete(this,GridStack.prototype.column,"setGridWidth","column","v0.5.3"),this.setColumn=utils_1.obsolete(this,GridStack.prototype.column,"setColumn","column","v0.6.4"),this.getGridHeight=utils_1.obsolete(this,gridstack_engine_1.GridStackEngine.prototype.getRow,"getGridHeight","getRow","v1.0.0"),this.el=t,e=e||{},utils_1.obsoleteOpts(e,"width","column","v0.5.3"),utils_1.obsoleteOpts(e,"height","maxRow","v0.5.3"),utils_1.obsoleteOpts(e,"verticalMargin","margin","v2.0"),utils_1.obsoleteOptsDel(e,"oneColumnModeClass","v0.6.3",". Use class `.grid-stack-1` instead"),utils_1.obsoleteAttr(this.el,"data-gs-width","data-gs-column","v0.5.3"),utils_1.obsoleteAttr(this.el,"data-gs-height","data-gs-max-row","v0.5.3"),utils_1.obsoleteAttr(this.el,"data-gs-current-height","data-gs-current-row","v1.0.0"),e.row&&(e.minRow=e.maxRow=e.row,delete e.row);let i=utils_1.Utils.toNumber(t.getAttribute("data-gs-row")),s={column:utils_1.Utils.toNumber(t.getAttribute("data-gs-column"))||12,minRow:i||(utils_1.Utils.toNumber(t.getAttribute("data-gs-min-row"))||0),maxRow:i||(utils_1.Utils.toNumber(t.getAttribute("data-gs-max-row"))||0),itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,styleInHead:!1,cellHeight:"auto",margin:10,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:utils_1.Utils.toBool(t.getAttribute("data-gs-animate"))||!1,alwaysShowResizeHandle:!1,resizable:{autoHide:!e.alwaysShowResizeHandle,handles:"se"},draggable:{handle:(e.handleClass?"."+e.handleClass:e.handle?e.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"},dragIn:void 0,dragInOptions:{revert:"invalid",handle:".grid-stack-item-content",scroll:!1,appendTo:"body"},disableDrag:!1,disableResize:!1,rtl:"auto",removable:!1,removableOptions:{accept:"."+(e.itemClass||"grid-stack-item")},removeTimeout:2e3,marginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:!1,oneColumnModeDomSort:!1};if(this.opts=utils_1.Utils.defaults(e,s),this.initMargin(),!1===this.opts.ddPlugin?this.opts.ddPlugin=gridstack_dd_1.GridStackDD:void 0===this.opts.ddPlugin&&(this.opts.ddPlugin=gridstack_dd_1.GridStackDD.get()),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===t.style.direction),this.opts.rtl&&this.el.classList.add("grid-stack-rtl"),this.opts._isNested=null!==utils_1.Utils.closestByClass(this.el,e.itemClass),this.opts._isNested&&this.el.classList.add("grid-stack-nested"),this._isAutoCellHeight="auto"===this.opts.cellHeight,this._isAutoCellHeight){let t=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;this.cellHeight(this.cellWidth()+t,!1)}else this.cellHeight(this.opts.cellHeight,!1);if(this.el.classList.add(this.opts._class),this._setStaticClass(),this._initStyles(),this.engine=new gridstack_engine_1.GridStackEngine(this.opts.column,(t,e=!0)=>{let i=0;this.engine.nodes.forEach(t=>{i=Math.max(i,t.y+t.height)}),t.forEach(t=>{let i=t.el;e&&null===t._id?i&&i.parentNode&&i.parentNode.removeChild(i):this._writeAttrs(i,t.x,t.y,t.width,t.height)}),this._updateStyles(i+10)},this.opts.float,this.opts.maxRow),this.opts.auto){let t=[];this.getGridItems().forEach(e=>{let i=parseInt(e.getAttribute("data-gs-x")),s=parseInt(e.getAttribute("data-gs-y"));t.push({el:e,i:(Number.isNaN(i)?1e3:i)+(Number.isNaN(s)?1e3:s)*this.opts.column})}),t.sort(t=>t.i).forEach(t=>{this._prepareElement(t.el)})}this.engine.saveInitial(),this.setAnimation(this.opts.animate);let r=document.createElement("div");r.className="placeholder-content",r.innerHTML=this.opts.placeholderText,this.placeholder=document.createElement("div"),this.placeholder.classList.add(this.opts.placeholderClass,this.opts.itemClass),this.placeholder.appendChild(r),this._updateContainerHeight(),window.addEventListener("resize",this._onResizeHandler.bind(this)),this._onResizeHandler(),this._setupDragIn(),this._setupRemoveDrop(),this._setupAcceptWidget()}static init(t={},e=".grid-stack"){let i=GridStack.getGridElement(e);return i?(i.gridstack||(i.gridstack=new GridStack(i,utils_1.Utils.clone(t))),i.gridstack):("string"==typeof e?console.log("gridstack.js: init() no grid was found. Did you forget class "+e+' on your element ?\n".grid-stack" is required for proper CSS styling and drag/drop.'):console.log("gridstack.js: init() no grid element was passed."),null)}static initAll(t={},e=".grid-stack"){let i=[];return GridStack.getGridElements(e).forEach(e=>{e.gridstack||(e.gridstack=new GridStack(e,utils_1.Utils.clone(t))),i.push(e.gridstack)}),0===i.length&&console.log("gridstack.js: initAll() no grid was found. Did you forget class "+e+' on your element ?\n".grid-stack" is required for proper CSS styling and drag/drop.'),i}addWidget(t,e){if(arguments.length>2){console.warn("gridstack.ts: `addWidget(el, x, y, width...)` is deprecated. Use `addWidget(el, {x, y, width,...})`. It will be removed soon");let e=arguments,i=1,s={x:e[i++],y:e[i++],width:e[i++],height:e[i++],autoPosition:e[i++],minWidth:e[i++],maxWidth:e[i++],minHeight:e[i++],maxHeight:e[i++],id:e[i++]};return this.addWidget(t,s)}if("string"==typeof t){let e=document.implementation.createHTMLDocument();e.body.innerHTML=t,t=e.body.children[0]}if(e){let i=this._readAttr(t);utils_1.Utils.defaults(e,i),this.engine.prepareNode(e),this._writeAttr(t,e)}return this.el.appendChild(t),this.makeWidget(t)}save(){return this.engine.save()}load(t,e=!0){let i=GridStack.Utils.sort(t),s=[];if(this.batchUpdate(),e){[...this.engine.nodes].forEach(t=>{i.find(e=>t.id===e.id)||("function"==typeof e?e(t,!1):(s.push(t),this.removeWidget(t.el,!0,!1)))})}i.forEach(t=>{let i=this.engine.nodes.find(e=>e.id===t.id);i?this.update(i.el,t.x,t.y,t.width,t.height):e&&("function"==typeof e?e(t,!0):this.addWidget('<div><div class="grid-stack-item-content"></div></div>',t))}),this.engine.removedNodes=s,this.commit()}batchUpdate(){return this.engine.batchUpdate(),this}getCellHeight(){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight)return this.opts.cellHeight;let t=this.el.querySelector("."+this.opts.itemClass),e=utils_1.Utils.toNumber(t.getAttribute("data-gs-height"));return Math.round(t.offsetHeight/e)}cellHeight(t,e=!0){let i=utils_1.Utils.parseHeight(t);return this.opts.cellHeightUnit===i.unit&&this.opts.cellHeight===i.height?this:(this.opts.cellHeightUnit=i.unit,this.opts.cellHeight=i.height,e&&this._updateStyles(),this)}cellWidth(){return this.el.offsetWidth/this.opts.column}commit(){return this.engine.commit(),this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent(),this}compact(){return this.engine.compact(),this._triggerChangeEvent(),this}column(t,e){if(this.opts.column===t)return this;let i=this.opts.column;if(1===t?this._prevColumn=i:delete this._prevColumn,this.el.classList.remove("grid-stack-"+i),this.el.classList.add("grid-stack-"+t),this.opts.column=this.engine.column=t,!0===e)return this;let s=void 0;return 1===t&&this.opts.oneColumnModeDomSort&&(s=[],this.getGridItems().forEach(t=>{t.gridstackNode&&s.push(t.gridstackNode)}),s.length||(s=void 0)),this.engine.updateNodeWidths(i,t,s),this._triggerChangeEvent(!0),this}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter(t=>t.matches("."+this.opts.itemClass)&&!t.matches("."+this.opts.placeholderClass))}destroy(t=!0){return window.removeEventListener("resize",this._onResizeHandler),this.disable(),t?this.el.parentNode.removeChild(this.el):(this.removeAll(t),this.el.classList.remove(this.opts._class),delete this.el.gridstack),utils_1.Utils.removeStylesheet(this._stylesId),delete this.engine,this}disable(){return this.enableMove(!1),this.enableResize(!1),this._triggerEvent("disable"),this}enable(){return this.enableMove(!0),this.enableResize(!0),this._triggerEvent("enable"),this}enableMove(t,e=!0){return this.getGridItems().forEach(e=>this.movable(e,t)),e&&(this.opts.disableDrag=!t),this}enableResize(t,e=!0){return this.getGridItems().forEach(e=>this.resizable(e,t)),e&&(this.opts.disableResize=!t),this}float(t){return this.engine.float=t,this._triggerChangeEvent(),this}getFloat(){return this.engine.float}getCellFromPixel(t,e=!1){let i,s=this.el.getBoundingClientRect();i=e?{top:s.top+document.documentElement.scrollTop,left:s.left}:{top:this.el.offsetTop,left:this.el.offsetLeft};let r=t.left-i.left,o=t.top-i.top,d=s.width/this.opts.column,a=s.height/parseInt(this.el.getAttribute("data-gs-current-row"));return{x:Math.floor(r/d),y:Math.floor(o/a)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow)}isAreaEmpty(t,e,i,s){return this.engine.isAreaEmpty(t,e,i,s)}locked(t,e){return this.getElements(t).forEach(t=>{let i=t.gridstackNode;i&&(i.locked=e||!1,i.locked?t.setAttribute("data-gs-locked","yes"):t.removeAttribute("data-gs-locked"))}),this}makeWidget(t){let e=this.getElement(t);return this._prepareElement(e,!0),this._updateContainerHeight(),this._triggerAddEvent(),this._triggerChangeEvent(),e}maxWidth(t,e){return this.getElements(t).forEach(t=>{let i=t.gridstackNode;i&&(i.maxWidth=e||void 0,e?t.setAttribute("data-gs-max-width",String(e)):t.removeAttribute("data-gs-max-width"))}),this}minWidth(t,e){return this.getElements(t).forEach(t=>{t.gridstackNode&&(e?t.setAttribute("data-gs-min-width",String(e)):t.removeAttribute("data-gs-min-width"))}),this}maxHeight(t,e){return this.getElements(t).forEach(t=>{t.gridstackNode&&(e?t.setAttribute("data-gs-max-height",String(e)):t.removeAttribute("data-gs-max-height"))}),this}minHeight(t,e){return this.getElements(t).forEach(t=>{t.gridstackNode&&(e?t.setAttribute("data-gs-min-height",String(e)):t.removeAttribute("data-gs-min-height"))}),this}movable(t,e){return this.getElements(t).forEach(t=>{let i=t.gridstackNode;i&&(i.noMove=!e,i.noMove?(this.dd.draggable(t,"disable"),t.classList.remove("ui-draggable-handle")):(this.dd.draggable(t,"enable"),t.classList.remove("ui-draggable-handle")))}),this}move(t,e,i){return this._updateElement(t,(t,s)=>{e=void 0!==e?e:s.x,i=void 0!==i?i:s.y,this.engine.moveNode(s,e,i,s.width,s.height)}),this}on(t,e){if(-1!==t.indexOf(" ")){return t.split(" ").forEach(t=>this.on(t,e)),this}if("change"===t||"added"===t||"removed"===t||"enable"===t||"disable"===t){let i="enable"===t||"disable"===t;this._gsEventHandler[t]=i?t=>e(t):t=>e(t,t.detail),this.el.addEventListener(t,this._gsEventHandler[t])}else"dragstart"===t||"dragstop"===t||"resizestart"===t||"resizestop"===t||"dropped"===t?this._gsEventHandler[t]=e:console.log("gridstack.on("+t+") event not supported");return this}off(t){if(-1!==t.indexOf(" ")){return t.split(" ").forEach(t=>this.off(t)),this}return"change"!==t&&"added"!==t&&"removed"!==t&&"enable"!==t&&"disable"!==t||this._gsEventHandler[t]&&this.el.removeEventListener(t,this._gsEventHandler[t]),delete this._gsEventHandler[t],this}removeWidget(t,e=!0,i=!0){return this.getElements(t).forEach(t=>{if(t.parentElement!==this.el)return;let s=t.gridstackNode;s||(s=this.engine.nodes.find(e=>t===e.el)),s&&(delete t.gridstackNode,this.dd.draggable(t,"destroy").resizable(t,"destroy"),this.engine.removeNode(s,e,i),e&&t.parentElement&&t.remove())}),i&&(this._triggerRemoveEvent(),this._triggerChangeEvent()),this}removeAll(t=!0){return this.engine.nodes.forEach(t=>{delete t.el.gridstackNode,this.dd.draggable(t.el,"destroy").resizable(t.el,"destroy")}),this.engine.removeAll(t),this._triggerRemoveEvent(),this}resize(t,e,i){return this._updateElement(t,(t,s)=>{e=e||s.width,i=i||s.height,this.engine.moveNode(s,s.x,s.y,e,i)}),this}resizable(t,e){return this.getElements(t).forEach(t=>{let i=t.gridstackNode;i&&(i.noResize=!e,i.noResize?this.dd.resizable(t,"disable"):this.dd.resizable(t,"enable"))}),this}setAnimation(t){return t?this.el.classList.add("grid-stack-animate"):this.el.classList.remove("grid-stack-animate"),this}setStatic(t){return this.opts.staticGrid=!0===t,this.enableMove(!t),this.enableResize(!t),this._setStaticClass(),this}update(t,e,i,s,r){return this._updateElement(t,(t,o)=>{e=void 0!==e?e:o.x,i=void 0!==i?i:o.y,s=s||o.width,r=r||o.height,this.engine.moveNode(o,e,i,s,r)}),this}margin(t){let e=utils_1.Utils.parseHeight(t);if(this.opts.marginUnit!==e.unit||this.opts.margin!==e.height)return this.opts.marginUnit=e.unit,this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=this.opts.margin=e.height,this._updateStyles(),this}getMargin(){return this.opts.margin}willItFit(t,e,i,s,r){return this.engine.canBePlacedWithRespectToHeight({x:t,y:e,width:i,height:s,autoPosition:r})}_triggerChangeEvent(t){if(this.engine.batchMode)return this;let e=this.engine.getDirtyNodes(!0);return e&&e.length&&(t||this.engine.layoutsNodesChange(e),this._triggerEvent("change",e)),this.engine.saveInitial(),this}_triggerAddEvent(){return this.engine.batchMode?this:(this.engine.addedNodes&&this.engine.addedNodes.length>0&&(this.engine.layoutsNodesChange(this.engine.addedNodes),this.engine.addedNodes.forEach(t=>{delete t._dirty}),this._triggerEvent("added",this.engine.addedNodes),this.engine.addedNodes=[]),this)}_triggerRemoveEvent(){return this.engine.batchMode?this:(this.engine.removedNodes&&this.engine.removedNodes.length>0&&(this._triggerEvent("removed",this.engine.removedNodes),this.engine.removedNodes=[]),this)}_triggerEvent(t,e){let i=e?new CustomEvent(t,{bubbles:!1,detail:e}):new Event(t);return this.el.dispatchEvent(i),this}_initStyles(){this._stylesId&&utils_1.Utils.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed();let t=this.opts.styleInHead?void 0:this.el.parentNode;return this._styles=utils_1.Utils.createStylesheet(this._stylesId,t),null!==this._styles&&(this._styles._max=0),this}_updateStyles(t){if(!this._styles)return this;if(void 0===t&&(t=this._styles._max),this._initStyles(),this._updateContainerHeight(),!this.opts.cellHeight)return this;if(0!==this._styles._max&&t<=this._styles._max)return this;let e=this.opts.cellHeight,i=this.opts.cellHeightUnit,s=`.${this.opts._class} > .${this.opts.itemClass}`;if(0===this._styles._max){utils_1.Utils.addCSSRule(this._styles,s,`min-height: ${e}${i}`);let t=this.opts.marginTop+this.opts.marginUnit,r=this.opts.marginBottom+this.opts.marginUnit,o=this.opts.marginRight+this.opts.marginUnit,d=this.opts.marginLeft+this.opts.marginUnit,a=`${s} > .grid-stack-item-content`,h=`.${this.opts._class} > .grid-stack-placeholder > .placeholder-content`;utils_1.Utils.addCSSRule(this._styles,a,`top: ${t}; right: ${o}; bottom: ${r}; left: ${d};`),utils_1.Utils.addCSSRule(this._styles,h,`top: ${t}; right: ${o}; bottom: ${r}; left: ${d};`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-ne`,`right: ${o}`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-e`,`right: ${o}`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-se`,`right: ${o}; bottom: ${r}`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-nw`,`left: ${d}`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-w`,`left: ${d}`),utils_1.Utils.addCSSRule(this._styles,`${s} > .ui-resizable-sw`,`left: ${d}; bottom: ${r}`)}if(t>this._styles._max){let r=t=>e*t+i;for(let e=this._styles._max+1;e<=t;e++){let t=r(e);utils_1.Utils.addCSSRule(this._styles,`${s}[data-gs-y="${e-1}"]`,`top: ${r(e-1)}`),utils_1.Utils.addCSSRule(this._styles,`${s}[data-gs-height="${e}"]`,`height: ${t}`),utils_1.Utils.addCSSRule(this._styles,`${s}[data-gs-min-height="${e}"]`,`min-height: ${t}`),utils_1.Utils.addCSSRule(this._styles,`${s}[data-gs-max-height="${e}"]`,`max-height: ${t}`)}this._styles._max=t}return this}_updateContainerHeight(){if(this.engine.batchMode)return this;let t=this.getRow(),e=parseInt(getComputedStyle(this.el)["min-height"]);if(e>0){let i=Math.round(e/this.getCellHeight());t<i&&(t=i)}if(this.el.setAttribute("data-gs-current-row",String(t)),0===t)return this.el.style.removeProperty("height"),this;let i=this.opts.cellHeight,s=this.opts.cellHeightUnit;return i?(this.el.style.height=t*i+s,this):this}_setupRemovingTimeout(t){let e=t.gridstackNode;return e&&!e._removeTimeout&&this.opts.removable?(e._removeTimeout=setTimeout(()=>{t.classList.add("grid-stack-item-removing"),e._isAboutToRemove=!0},this.opts.removeTimeout),this):this}_clearRemovingTimeout(t){let e=t.gridstackNode;return e&&e._removeTimeout?(clearTimeout(e._removeTimeout),delete e._removeTimeout,t.classList.remove("grid-stack-item-removing"),delete e._isAboutToRemove,this):this}_prepareDragDropByNode(t){let e,i,s=t.el,r=(r,o)=>{this._gsEventHandler[r.type]&&this._gsEventHandler[r.type](r,r.target),this.engine.cleanNodes(),this.engine.beginUpdate(t),e=this.cellWidth(),i=this.getCellHeight();let{target:d}=r;this.placeholder.setAttribute("data-gs-x",d.getAttribute("data-gs-x")),this.placeholder.setAttribute("data-gs-y",d.getAttribute("data-gs-y")),this.placeholder.setAttribute("data-gs-width",d.getAttribute("data-gs-width")),this.placeholder.setAttribute("data-gs-height",d.getAttribute("data-gs-height")),this.el.append(this.placeholder),t.el=this.placeholder,t._beforeDragX=t.x,t._beforeDragY=t.y,t._prevYPix=o.position.top;let a=t.minHeight||1;if(this.dd.resizable(s,"option","minWidth",e*(t.minWidth||1)),this.dd.resizable(s,"option","minHeight",i*a),"resizestart"===r.type){let t=d.querySelector(".grid-stack-item");if(t){document.createEvent("HTMLEvents").initEvent("resizestart",!0,!1),t.dispatchEvent(r)}}},o=(r,o)=>{let d,a,h=Math.round(o.position.left/e),l=Math.floor((o.position.top+i/2)/i);if("drag"===r.type){let e=o.position.top-t._prevYPix;if(t._prevYPix=o.position.top,utils_1.Utils.updateScrollPosition(s,o.position,e),s.dataset.inTrashZone||h<0||h>=this.engine.column||l<0||!this.engine.float&&l>this.engine.getRow()){if(t._temporaryRemoved)return;!0===this.opts.removable&&this._setupRemovingTimeout(s),h=t._beforeDragX,l=t._beforeDragY,this.placeholder.parentNode===this.el&&this.el.removeChild(this.placeholder),this.engine.removeNode(t),this._updateContainerHeight(),t._temporaryRemoved=!0}else this._clearRemovingTimeout(s),t._temporaryRemoved&&(this.engine.addNode(t),this._writeAttrs(this.placeholder,h,l,d,a),this.el.appendChild(this.placeholder),t.el=this.placeholder,delete t._temporaryRemoved)}else if("resize"===r.type){if(h<0)return;d=Math.round(o.size.width/e),a=Math.round((o.size.height+this.getMargin())/i)}let n=d||t._lastTriedWidth,g=a||t._lastTriedHeight;!this.engine.canMoveNode(t,h,l,d,a)||t._lastTriedX===h&&t._lastTriedY===l&&t._lastTriedWidth===n&&t._lastTriedHeight===g||(t._lastTriedX=h,t._lastTriedY=l,t._lastTriedWidth=d,t._lastTriedHeight=a,this.engine.moveNode(t,h,l,d,a),this._updateContainerHeight())},d=e=>{this.placeholder.parentNode===this.el&&this.el.removeChild(this.placeholder);let i=e.target;if(i.gridstackNode&&i.gridstackNode.grid===this){if(t.el=i,t._isAboutToRemove){let r=s.gridstackNode.grid;r._gsEventHandler[e.type]&&r._gsEventHandler[e.type](e,i),r.engine.removedNodes.push(t),r.dd.draggable(s,"destroy").resizable(s,"destroy"),delete s.gridstackNode,r._triggerRemoveEvent(),s.parentElement&&s.remove()}else this._clearRemovingTimeout(s),t._temporaryRemoved?(utils_1.Utils.removePositioningStyles(i),this._writeAttrs(i,t._beforeDragX,t._beforeDragY,t.width,t.height),t.x=t._beforeDragX,t.y=t._beforeDragY,delete t._temporaryRemoved,this.engine.addNode(t)):(utils_1.Utils.removePositioningStyles(i),this._writeAttrs(i,t.x,t.y,t.width,t.height)),this._gsEventHandler[e.type]&&this._gsEventHandler[e.type](e,i);this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate(),"resizestop"===e.type&&i.querySelectorAll(".grid-stack").forEach(t=>t.gridstack._onResizeHandler())}};return this.dd.draggable(s,{start:r,stop:d,drag:o}).resizable(s,{start:r,stop:d,resize:o}),(t.noMove||this.opts.disableDrag||this.opts.staticGrid)&&this.dd.draggable(s,"disable"),(t.noResize||this.opts.disableResize||this.opts.staticGrid)&&this.dd.resizable(s,"disable"),this._writeAttr(s,t),this}_prepareElement(t,e=!1){t.classList.add(this.opts.itemClass);let i=this._readAttr(t,{el:t,grid:this});return i=this.engine.addNode(i,e),t.gridstackNode=i,this._prepareDragDropByNode(i),this}_writeAttrs(t,e,i,s,r){return null!=e&&t.setAttribute("data-gs-x",String(e)),null!=i&&t.setAttribute("data-gs-y",String(i)),s&&t.setAttribute("data-gs-width",String(s)),r&&t.setAttribute("data-gs-height",String(r)),this}_writeAttr(t,e){return e?(this._writeAttrs(t,e.x,e.y,e.width,e.height),e.autoPosition?t.setAttribute("data-gs-auto-position","true"):t.removeAttribute("data-gs-auto-position"),e.minWidth&&t.setAttribute("data-gs-min-width",String(e.minWidth)),e.maxWidth&&t.setAttribute("data-gs-max-width",String(e.maxWidth)),e.minHeight&&t.setAttribute("data-gs-min-height",String(e.minHeight)),e.maxHeight&&t.setAttribute("data-gs-max-height",String(e.maxHeight)),e.noResize?t.setAttribute("data-gs-no-resize","true"):t.removeAttribute("data-gs-no-resize"),e.noMove?t.setAttribute("data-gs-no-move","true"):t.removeAttribute("data-gs-no-move"),e.locked?t.setAttribute("data-gs-locked","true"):t.removeAttribute("data-gs-locked"),e.resizeHandles&&t.setAttribute("data-gs-resize-handles",e.resizeHandles),e.id&&t.setAttribute("data-gs-id",String(e.id)),this):this}_readAttr(t,e={}){return e.x=utils_1.Utils.toNumber(t.getAttribute("data-gs-x")),e.y=utils_1.Utils.toNumber(t.getAttribute("data-gs-y")),e.width=utils_1.Utils.toNumber(t.getAttribute("data-gs-width")),e.height=utils_1.Utils.toNumber(t.getAttribute("data-gs-height")),e.maxWidth=utils_1.Utils.toNumber(t.getAttribute("data-gs-max-width")),e.minWidth=utils_1.Utils.toNumber(t.getAttribute("data-gs-min-width")),e.maxHeight=utils_1.Utils.toNumber(t.getAttribute("data-gs-max-height")),e.minHeight=utils_1.Utils.toNumber(t.getAttribute("data-gs-min-height")),e.autoPosition=utils_1.Utils.toBool(t.getAttribute("data-gs-auto-position")),e.noResize=utils_1.Utils.toBool(t.getAttribute("data-gs-no-resize")),e.noMove=utils_1.Utils.toBool(t.getAttribute("data-gs-no-move")),e.locked=utils_1.Utils.toBool(t.getAttribute("data-gs-locked")),e.resizeHandles=t.getAttribute("data-gs-resize-handles"),e.id=t.getAttribute("data-gs-id"),e}_updateElement(t,e){let i=this.getElement(t);if(!i)return this;let s=i.gridstackNode;return s?(this.engine.cleanNodes(),this.engine.beginUpdate(s),e.call(this,i,s),this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate(),this):this}_setStaticClass(){return!0===this.opts.staticGrid?this.el.classList.add("grid-stack-static"):this.el.classList.remove("grid-stack-static"),this}_onResizeHandler(){if(this._isAutoCellHeight&&utils_1.Utils.throttle(()=>{let t=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;this.cellHeight(this.cellWidth()+t)},100),!this.opts.disableOneColumnMode&&this.el.clientWidth<=this.opts.minWidth){if(this._oneColumnMode)return this;this._oneColumnMode=!0,this.column(1)}else{if(!this._oneColumnMode)return this;delete this._oneColumnMode,this.column(this._prevColumn)}return this}_setupDragIn(){return this.opts.staticGrid||"string"!=typeof this.opts.dragIn||this.dd.isDraggable(this.opts.dragIn)||this.dd.dragIn(this.opts.dragIn,this.opts.dragInOptions),this}_setupRemoveDrop(){if(!this.opts.staticGrid&&"string"==typeof this.opts.removable){let t=document.querySelector(this.opts.removable);if(!t)return this;this.dd.isDroppable(t)||this.dd.droppable(t,this.opts.removableOptions),this.dd.on(t,"dropover",(t,e)=>{let i=e.gridstackNode;i&&i.grid===this&&(e.dataset.inTrashZone="true",this._setupRemovingTimeout(e))}).on(t,"dropout",(t,e)=>{let i=e.gridstackNode;i&&i.grid===this&&(delete e.dataset.inTrashZone,this._clearRemovingTimeout(e))})}return this}_setupAcceptWidget(){if(this.opts.staticGrid||!this.opts.acceptWidgets)return this;let t=(t,e)=>{let i=e.gridstackNode,s=this.getCellFromPixel({left:t.pageX,top:t.pageY},!0),r=Math.max(0,s.x),o=Math.max(0,s.y);i._added?r===i.x&&o===i.y||!this.engine.canMoveNode(i,r,o)||(this.engine.moveNode(i,r,o),this._updateContainerHeight()):(i._added=!0,i.el=e,i.x=r,i.y=o,delete i.autoPosition,this.engine.cleanNodes(),this.engine.beginUpdate(i),this.engine.addNode(i),this._writeAttrs(this.placeholder,i.x,i.y,i.width,i.height),this.el.appendChild(this.placeholder),i.el=this.placeholder,i._beforeDragX=i.x,i._beforeDragY=i.y,this._updateContainerHeight())};return this.dd.droppable(this.el,{accept:t=>{let e=t.gridstackNode;if(e&&e.grid===this)return!1;if("function"==typeof this.opts.acceptWidgets)return this.opts.acceptWidgets(t);let i=!0===this.opts.acceptWidgets?".grid-stack-item":this.opts.acceptWidgets;return t.matches(i)}}).on(this.el,"dropover",(e,i)=>{let s,r,o=i.gridstackNode;if(!o||!o.width||!o.height){let t=parseInt(i.getAttribute("data-gs-width"));t>0&&((o=o||{}).width=t);let e=parseInt(i.getAttribute("data-gs-height"));e>0&&((o=o||{}).height=e)}let d=this.cellWidth(),a=this.getCellHeight();s=o&&o.width?o.width:Math.round(i.offsetWidth/d)||1,r=o&&o.height?o.height:Math.round(i.offsetHeight/a)||1;let h=this.engine.prepareNode({width:s,height:r,_added:!1,_temporary:!0});return h._isOutOfGrid=!0,i.gridstackNode=h,i._gridstackNodeOrig=o,this.dd.on(i,"drag",t),!1}).on(this.el,"dropout",(t,e)=>{let i=e.gridstackNode;if(i&&i._isOutOfGrid)return this.dd.off(e,"drag"),i.el=null,this.engine.removeNode(i),this.placeholder.parentNode===this.el&&this.el.removeChild(this.placeholder),this._updateContainerHeight(),e.gridstackNode=e._gridstackNodeOrig,!1}).on(this.el,"drop",(t,e,i)=>{this.placeholder.remove();let s=e._gridstackNodeOrig;if(delete e._gridstackNodeOrig,s&&s.grid&&s.grid!==this){let t=s.grid;t.placeholder.remove(),s.el=e,t.engine.removedNodes.push(s),t._triggerRemoveEvent()}let r=e.gridstackNode;return this.engine.cleanupNode(r),r.grid=this,this.dd.off(e,"drag"),i!==e?(i.remove(),e.gridstackNode=s,e=e.cloneNode(!0)):(e.remove(),this.dd.draggable(e,"destroy").resizable(e,"destroy")),e.gridstackNode=r,r.el=e,utils_1.Utils.removePositioningStyles(e),this._writeAttr(e,r),this.el.appendChild(e),this._updateContainerHeight(),this.engine.addedNodes.push(r),this._triggerAddEvent(),this._triggerChangeEvent(),this.engine.endUpdate(),this._gsEventHandler.dropped&&this._gsEventHandler.dropped({type:"dropped"},s&&s.grid?s:void 0,r),window.setTimeout(()=>{r.el&&r.el.parentElement&&this._prepareDragDropByNode(r)}),!1}),this}getElement(t=".grid-stack-item"){return"string"==typeof t?document.querySelector(t)||document.querySelector("#"+t)||document.querySelector("."+t):t}getElements(t=".grid-stack-item"){if("string"==typeof t){let e=document.querySelectorAll(t);return e.length||(e=document.querySelectorAll("."+t)),e.length||(e=document.querySelectorAll("#"+t)),Array.from(e)}return[t]}static getGridElement(t=".grid-stack"){return"string"==typeof t?document.querySelector(t)||document.querySelector("#"+t)||document.querySelector("."+t):t}static getGridElements(t=".grid-stack"){if("string"==typeof t){let e=document.querySelectorAll(t);return e.length||(e=document.querySelectorAll("."+t)),e.length||(e=document.querySelectorAll("#"+t)),Array.from(e)}return[t]}initMargin(){let t=utils_1.Utils.parseHeight(this.opts.margin);this.opts.marginUnit=t.unit;let e=this.opts.margin=t.height;return void 0===this.opts.marginTop?this.opts.marginTop=e:(t=utils_1.Utils.parseHeight(this.opts.marginTop),this.opts.marginTop=t.height,delete this.opts.margin),void 0===this.opts.marginBottom?this.opts.marginBottom=e:(t=utils_1.Utils.parseHeight(this.opts.marginBottom),this.opts.marginBottom=t.height,delete this.opts.margin),void 0===this.opts.marginRight?this.opts.marginRight=e:(t=utils_1.Utils.parseHeight(this.opts.marginRight),this.opts.marginRight=t.height,delete this.opts.margin),void 0===this.opts.marginLeft?this.opts.marginLeft=e:(t=utils_1.Utils.parseHeight(this.opts.marginLeft),this.opts.marginLeft=t.height,delete this.opts.margin),this.opts.marginUnit=t.unit,this}}GridStack.Utils=utils_1.Utils,GridStack.Engine=gridstack_engine_1.GridStackEngine,exports.GridStack=GridStack;
//# sourceMappingURL=/sm/55059b43673eefb4a5df20e15a811a3ad188a24f00c95e4d3c264f5f6d16c2b9.map